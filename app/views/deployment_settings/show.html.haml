- content_for(:body_id, 'deployment_flow')

%h1 Deployment Settings

.deployment-metadata
  %h3 Target
  %dl
    %dt Endpoint
    %dd 192.168.1.1
    %dt Agent
    %dd 1.1.0.1
    %dt Adapter
    %dd Bob
    %dt Type
    %dd Kubernetes
%h2
  = @template.name

.deployment-settings
  - @template.images.each do |image|
    %h3
      = image.name
    = form_for [image], html: { class: 'service-edit-form' } do |f|
      .tab-container
        .tabs.column
          .hide
            %label{ for: 'hide' }
              .icon
              .text Hide Tabs
          .tab
            %label{ for: 'vars' }
              .icon
              .text Environment Variables
          .tab
            %label{ for: 'options' }
              .icon
              .text
                Options
        .cards.column
          .card.vars
            .content
              .title
                %h3 Environment Variables
              .environment-variables
                = f.fields_for :environment do |env_var|
                  - index = env_var.options[:child_index]

                  %dl.entries
                    %dt.variable-name
                      = env_var.label(:value, env_var.object.variable, data: { index: "#{index}" })
                      .actions
                        %a{ class: 'edit-action' }
                    %dd.variable-value
                      - if env_var.object.value.blank?
                        = env_var.text_field :value, placeholder: 'enter a value', class: 'empty', data: { index: "#{index}" }
                      - else
                        %span{ data: { index: "#{index}" } }
                          = env_var.object.value
                        .actions
                          %a{ class: 'edit-action' }
                    %dd.actions
                      - checkbox_id = "select_environment_variable_#{index}"
                      = env_var.check_box :_deleted, { id: checkbox_id }
                      = env_var.hidden_field :variable, data: { index: "name_#{index}" }
                      = env_var.hidden_field :value, data: { index: "value_#{index}" }
                      %a{class: 'delete-action', title: 'remove', data: { checkbox: { selector: "##{checkbox_id}" } } } remove

                .additional-entries
                  = add_fields_for(:environment, f, { child_index: '_replaceme_' }) do |builder|
                    %dl
                      %dt.editing
                        = builder.text_field :variable, disabled: true, placeholder: 'Label', class: 'variable-name'
                      %dd.editing
                        = builder.text_field :value, disabled: true, placeholder: 'Value', class: 'variable-value'
                      %a.cancel Cancel

                %a.button-add Add an Environment Variable
          .card.options
            .content
              .title
                %h3 Options
                %dl.entries
                  %p
                    %dt.variable-name
                      Deploy Count
                    %dd.variable-value
                      = select :count, :count, options_for_select([["1", "1"], ["2", "2"], ["3", "3"]]), {}, class: 'fancy'
                  %p
                    %dt.variable-name.disabled
                      Cohost?
                    %dd.variable-value.disabled
                      .styled-radio
                        = f.radio_button :name, true, { :disabled => true }
                        %label{ :for => 'image_name_true' }
                      Yes
                      .styled-radio
                        = f.radio_button :name, false, { :disabled => true }
                        %label{ :for => 'image_name_false' }
                      No
                  %p
                    %dt.variable-name.disabled
                      Restart Policy
                    %dd.variable-value
                      = select :count, :count, options_for_select([["Always", "Always"], ["Never", "Never"], ["Once", "Once"]]), {}, class: 'fancy', disabled: true
